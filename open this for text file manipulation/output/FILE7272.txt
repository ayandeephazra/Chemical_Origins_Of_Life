If Sn 4d are treated as core electron, the formation energy of an impurity X occupying the O site in SnO2 is given by(31)EfXOq=EtXOq-Et[SnO2]+?O-?X+q?Fwhere E t[XOq] is the total energy of the supercell containing the impurity X (X=N, P, As, or Sb) in the charge state q, and E t[SnO2] is the total energy of a perfect crystal in the same supercell.